from functools import partial

import jax
import jax.numpy as jnp
import numpy as onp
from scipy import optimize
from tensorflow_probability.substrates import jax as tfp

@jax.jit
def rho(x):
  return x**3

@jax.jit
def sigma(x):
  return rho(x)/(rho(x)+rho(1-x))

@jax.jit
def g(x,a,b):
  return sigma(a*(x-b)+0.5)

@jax.jit
def f(x,a,b,c):
  return (1-c)*((g(x,a,b)-g(jnp.zeros_like(x),a,b))/(g(jnp.ones_like(x),a,b)-g(jnp.zeros_like(x),a,b)))+c*x

# return the diag of the jacobian
@jax.jit
def gradf(x,a,b,c):
  res = (c + (1 - c)*(3*a*(a*(-b + x) + 0.5)**2/((-a*(-b + x) + 0.5)**3 + (a*(-b + x) + 0.5)**3) + (a*(-b + x) + 0.5)**3*(3*a*(-a*(-b + x) + 0.5)**2 - 3*a*(a*(-b + x) + 0.5)**2)/((-a*(-b + x) + 0.5)**3 + (a*(-b + x) + 0.5)**3)**2)/(-(-a*b + 0.5)**3/((-a*b + 0.5)**3 + (a*b + 0.5)**3) + (a*(1 - b) + 0.5)**3/((-a*(1 - b) + 0.5)**3 + (a*(1 - b) + 0.5)**3)))
  return res

@jax.jit
def inv_f(y, a, b, c):
  """Analytic inverse of f computed with sympy"""
  return (-1/9*2**(1/3)*(-3*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 4.0*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2)/(jnp.sqrt(-0.35116598079561*(-0.75*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + (-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2)**3 + ((-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - 1/3*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))**2) + (-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - 1/3*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))**(1/3) - 1/2*2**(2/3)*(jnp.sqrt(-0.35116598079561*(-0.75*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + (-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2)**3 + ((-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - 1/3*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))**2) + (-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - 1/3*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))**(1/3) - 1/3*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)/(0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111))

  return ((-0.139991227766097*(-0.75*a**6*b**6 - 1.5*a**6*b**5*y + 1.5*a**6*b**5 + 3.0*a**6*b**4*y - 0.75*a**6*b**4 - 1.5*a**6*b**3*y + 0.312500000000001*a**4*b**4 + 0.500000000000001*a**4*b**3*c + 0.75*a**4*b**3*y - 0.75*a**4*b**3 - 0.500000000000001*a**4*b**2*c - 0.75*a**4*b**2*y + 0.375*a**4*b**2 - 0.125*a**4*b*y - 0.015625*a**2*b**2 - 0.125*a**2*b*c - 0.09375*a**2*b*y + 0.09375*a**2*b + 0.0416666666666667*a**2*c - 0.046875*a**2 - 0.00390624999999999)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) - 0.559964911064388*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2)*(jnp.sqrt(-0.35116598079561*((-0.1875*a**6*b**6 - 0.375*a**6*b**5*y + 0.375*a**6*b**5 + 0.75*a**6*b**4*y - 0.1875*a**6*b**4 - 0.375*a**6*b**3*y + 0.0781250000000002*a**4*b**4 + 0.125*a**4*b**3*c + 0.1875*a**4*b**3*y - 0.1875*a**4*b**3 - 0.125*a**4*b**2*c - 0.1875*a**4*b**2*y + 0.09375*a**4*b**2 - 0.03125*a**4*b*y - 0.00390625*a**2*b**2 - 0.03125*a**2*b*c - 0.0234375*a**2*b*y + 0.0234375*a**2*b + 0.0104166666666667*a**2*c - 0.01171875*a**2 - 0.000976562499999998)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + (-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2)**3 + ((-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - (-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))**2) + (-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - (-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))**(-1.33333333333333)*(-0.333333333333333*(-0.175582990397805*((-0.1875*a**6*b**6 - 0.375*a**6*b**5*y + 0.375*a**6*b**5 + 0.75*a**6*b**4*y - 0.1875*a**6*b**4 - 0.375*a**6*b**3*y + 0.0781250000000002*a**4*b**4 + 0.125*a**4*b**3*c + 0.1875*a**4*b**3*y - 0.1875*a**4*b**3 - 0.125*a**4*b**2*c - 0.1875*a**4*b**2*y + 0.09375*a**4*b**2 - 0.03125*a**4*b*y - 0.00390625*a**2*b**2 - 0.03125*a**2*b*c - 0.0234375*a**2*b*y + 0.0234375*a**2*b + 0.0104166666666667*a**2*c - 0.01171875*a**2 - 0.000976562499999998)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + (-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2)**2*(3*(-0.5*a**4*b**4 + a**4*b**3 - 0.5*a**4*b**2 + 0.25*a**2*b**2 - 0.25*a**2*b - 0.0416666666666666*a**2 - 0.03125)*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2 + 3*(-0.375*a**6*b**5 + 0.75*a**6*b**4 - 0.375*a**6*b**3 + 0.1875*a**4*b**3 - 0.1875*a**4*b**2 - 0.03125*a**4*b - 0.0234375*a**2*b)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)) + (1/2)*((-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - (-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))*(1.18518518518519*(-0.75*a**4*b**4 + 1.5*a**4*b**3 - 0.75*a**4*b**2 + 0.375*a**2*b**2 - 0.375*a**2*b - 0.0624999999999999*a**2 - 0.046875)*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - 2*(-0.0833333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2 + 0.0416666666666667*a**2*b**2 - 0.0416666666666667*a**2*b - 0.00694444444444443*a**2 - 0.00520833333333333)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)) - 2*(0.5*a**6*b**5 - 1.0*a**6*b**4 + 0.5*a**6*b**3 - 0.25*a**4*b**3 + 0.25*a**4*b**2 + 0.0416666666666667*a**4*b + 0.03125*a**2*b)*(-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)) + 2*(-0.25*a**6*b**6 + 0.5*a**6*b**5 - 0.25*a**6*b**4 + 0.104166666666667*a**4*b**4 - 0.0833333333333333*a**4*b**3 - 0.0416666666666667*a**4*b**2 - 0.00520833333333333*a**2*b**2 - 0.0104166666666667*a**2*b - 0.00173611111111111*a**2 - 0.00130208333333333)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))/jnp.sqrt(-0.35116598079561*((-0.1875*a**6*b**6 - 0.375*a**6*b**5*y + 0.375*a**6*b**5 + 0.75*a**6*b**4*y - 0.1875*a**6*b**4 - 0.375*a**6*b**3*y + 0.0781250000000002*a**4*b**4 + 0.125*a**4*b**3*c + 0.1875*a**4*b**3*y - 0.1875*a**4*b**3 - 0.125*a**4*b**2*c - 0.1875*a**4*b**2*y + 0.09375*a**4*b**2 - 0.03125*a**4*b*y - 0.00390625*a**2*b**2 - 0.03125*a**2*b*c - 0.0234375*a**2*b*y + 0.0234375*a**2*b + 0.0104166666666667*a**2*c - 0.01171875*a**2 - 0.000976562499999998)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + (-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2)**3 + ((-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - (-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))**2) - 0.197530864197531*(-0.75*a**4*b**4 + 1.5*a**4*b**3 - 0.75*a**4*b**2 + 0.375*a**2*b**2 - 0.375*a**2*b - 0.0624999999999999*a**2 - 0.046875)*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 + 0.333333333333333*(-0.0833333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2 + 0.0416666666666667*a**2*b**2 - 0.0416666666666667*a**2*b - 0.00694444444444443*a**2 - 0.00520833333333333)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)) + 0.333333333333333*(0.5*a**6*b**5 - 1.0*a**6*b**4 + 0.5*a**6*b**3 - 0.25*a**4*b**3 + 0.25*a**4*b**2 + 0.0416666666666667*a**4*b + 0.03125*a**2*b)*(-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)) - 0.333333333333333*(-0.25*a**6*b**6 + 0.5*a**6*b**5 - 0.25*a**6*b**4 + 0.104166666666667*a**4*b**4 - 0.0833333333333333*a**4*b**3 - 0.0416666666666667*a**4*b**2 - 0.00520833333333333*a**2*b**2 - 0.0104166666666667*a**2*b - 0.00173611111111111*a**2 - 0.00130208333333333)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)) + (-0.559964911064388*(-0.5*a**4*b**4 + a**4*b**3 - 0.5*a**4*b**2 + 0.25*a**2*b**2 - 0.25*a**2*b - 0.0416666666666666*a**2 - 0.03125)*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2 - 0.139991227766097*(-1.5*a**6*b**5 + 3.0*a**6*b**4 - 1.5*a**6*b**3 + 0.75*a**4*b**3 - 0.75*a**4*b**2 - 0.125*a**4*b - 0.09375*a**2*b)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2))*(jnp.sqrt(-0.35116598079561*((-0.1875*a**6*b**6 - 0.375*a**6*b**5*y + 0.375*a**6*b**5 + 0.75*a**6*b**4*y - 0.1875*a**6*b**4 - 0.375*a**6*b**3*y + 0.0781250000000002*a**4*b**4 + 0.125*a**4*b**3*c + 0.1875*a**4*b**3*y - 0.1875*a**4*b**3 - 0.125*a**4*b**2*c - 0.1875*a**4*b**2*y + 0.09375*a**4*b**2 - 0.03125*a**4*b*y - 0.00390625*a**2*b**2 - 0.03125*a**2*b*c - 0.0234375*a**2*b*y + 0.0234375*a**2*b + 0.0104166666666667*a**2*c - 0.01171875*a**2 - 0.000976562499999998)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + (-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2)**3 + ((-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - (-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))**2) + (-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - (-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))**(-0.333333333333333) - 0.7937005259841*(jnp.sqrt(-0.35116598079561*((-0.1875*a**6*b**6 - 0.375*a**6*b**5*y + 0.375*a**6*b**5 + 0.75*a**6*b**4*y - 0.1875*a**6*b**4 - 0.375*a**6*b**3*y + 0.0781250000000002*a**4*b**4 + 0.125*a**4*b**3*c + 0.1875*a**4*b**3*y - 0.1875*a**4*b**3 - 0.125*a**4*b**2*c - 0.1875*a**4*b**2*y + 0.09375*a**4*b**2 - 0.03125*a**4*b*y - 0.00390625*a**2*b**2 - 0.03125*a**2*b*c - 0.0234375*a**2*b*y + 0.0234375*a**2*b + 0.0104166666666667*a**2*c - 0.01171875*a**2 - 0.000976562499999998)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + (-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2)**3 + ((-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - (-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))**2) + (-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - (-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))**(-0.666666666666667)*(0.333333333333333*(-0.175582990397805*((-0.1875*a**6*b**6 - 0.375*a**6*b**5*y + 0.375*a**6*b**5 + 0.75*a**6*b**4*y - 0.1875*a**6*b**4 - 0.375*a**6*b**3*y + 0.0781250000000002*a**4*b**4 + 0.125*a**4*b**3*c + 0.1875*a**4*b**3*y - 0.1875*a**4*b**3 - 0.125*a**4*b**2*c - 0.1875*a**4*b**2*y + 0.09375*a**4*b**2 - 0.03125*a**4*b*y - 0.00390625*a**2*b**2 - 0.03125*a**2*b*c - 0.0234375*a**2*b*y + 0.0234375*a**2*b + 0.0104166666666667*a**2*c - 0.01171875*a**2 - 0.000976562499999998)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + (-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2)**2*(3*(-0.5*a**4*b**4 + a**4*b**3 - 0.5*a**4*b**2 + 0.25*a**2*b**2 - 0.25*a**2*b - 0.0416666666666666*a**2 - 0.03125)*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2 + 3*(-0.375*a**6*b**5 + 0.75*a**6*b**4 - 0.375*a**6*b**3 + 0.1875*a**4*b**3 - 0.1875*a**4*b**2 - 0.03125*a**4*b - 0.0234375*a**2*b)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)) + (1/2)*((-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - (-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))*(1.18518518518519*(-0.75*a**4*b**4 + 1.5*a**4*b**3 - 0.75*a**4*b**2 + 0.375*a**2*b**2 - 0.375*a**2*b - 0.0624999999999999*a**2 - 0.046875)*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - 2*(-0.0833333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2 + 0.0416666666666667*a**2*b**2 - 0.0416666666666667*a**2*b - 0.00694444444444443*a**2 - 0.00520833333333333)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)) - 2*(0.5*a**6*b**5 - 1.0*a**6*b**4 + 0.5*a**6*b**3 - 0.25*a**4*b**3 + 0.25*a**4*b**2 + 0.0416666666666667*a**4*b + 0.03125*a**2*b)*(-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)) + 2*(-0.25*a**6*b**6 + 0.5*a**6*b**5 - 0.25*a**6*b**4 + 0.104166666666667*a**4*b**4 - 0.0833333333333333*a**4*b**3 - 0.0416666666666667*a**4*b**2 - 0.00520833333333333*a**2*b**2 - 0.0104166666666667*a**2*b - 0.00173611111111111*a**2 - 0.00130208333333333)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))/jnp.sqrt(-0.35116598079561*((-0.1875*a**6*b**6 - 0.375*a**6*b**5*y + 0.375*a**6*b**5 + 0.75*a**6*b**4*y - 0.1875*a**6*b**4 - 0.375*a**6*b**3*y + 0.0781250000000002*a**4*b**4 + 0.125*a**4*b**3*c + 0.1875*a**4*b**3*y - 0.1875*a**4*b**3 - 0.125*a**4*b**2*c - 0.1875*a**4*b**2*y + 0.09375*a**4*b**2 - 0.03125*a**4*b*y - 0.00390625*a**2*b**2 - 0.03125*a**2*b*c - 0.0234375*a**2*b*y + 0.0234375*a**2*b + 0.0104166666666667*a**2*c - 0.01171875*a**2 - 0.000976562499999998)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + (-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**2)**3 + ((-0.25*a**6*b**6*y + 0.5*a**6*b**5*y - 0.25*a**6*b**4*y + 0.104166666666667*a**4*b**4*y - 0.0833333333333333*a**4*b**3*y - 0.0416666666666667*a**4*b**2*y - 0.00520833333333333*a**2*b**2*y - 0.0104166666666667*a**2*b*y - 0.00173611111111111*a**2*y - 0.00130208333333333*y)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2) + 0.592592592592593*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**3/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - (-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)))**2) + 0.197530864197531*(-0.75*a**4*b**4 + 1.5*a**4*b**3 - 0.75*a**4*b**2 + 0.375*a**2*b**2 - 0.375*a**2*b - 0.0624999999999999*a**2 - 0.046875)*(-0.5*a**4*b**5 - 0.25*a**4*b**4*y + 1.0*a**4*b**4 + 0.5*a**4*b**3*y - 0.5*a**4*b**3 - 0.25*a**4*b**2*y + 0.166666666666667*a**2*b**3*c + 0.0833333333333333*a**2*b**3 + 0.125*a**2*b**2*y - 0.25*a**2*b**2 - 0.166666666666667*a**2*b*c - 0.125*a**2*b*y + 0.125*a**2*b - 0.0208333333333333*a**2*y - 0.0416666666666667*b*c + 0.0104166666666667*b - 0.015625*y)**2/(0.5*a**4*b**4 - a**4*b**3 + 0.5*a**4*b**2 - 0.333333333333333*a**2*b**2*c + 0.0833333333333333*a**2*b**2 + 0.333333333333333*a**2*b*c - 0.0833333333333333*a**2*b + 0.0416666666666667*a**2 + 0.0277777777777778*c + 0.00347222222222222)**3 - 0.333333333333333*(-0.0833333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2 + 0.0416666666666667*a**2*b**2 - 0.0416666666666667*a**2*b - 0.00694444444444443*a**2 - 0.00520833333333333)*(0.25*a**6*b**6 + 0.5*a**6*b**5*y - 0.5*a**6*b**5 - 1.0*a**6*b**4*y + 0.25*a**6*b**4 + 0.5*a**6*b**3*y - 0.104166666666667*a**4*b**4 - 0.166666666666667*a**4*b**3*c - 0.25*a**4*b**3*y + 0.25*a**4*b**3 + 0.166666666666667*a**4*b**2*c + 0.25*a**4*b**2*y - 0.125*a**4*b**2 + 0.0416666666666667*a**4*b*y + 0.00520833333333333*a**2*b**2 + 0.0416666666666667*a**2*b*c + 0.03125*a**2*b*y - 0.03125*a**2*b - 0.0138888888888889*a**2*c + 0.015625*a**2 + 0.00130208333333333)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)) - 0.333333333333333*(0.5*a**6*b**5 - 1.0*a**6*b**4 + 0.5*a**6*b**3 - 0.25*a**4*b**3 + 0.25*a**4*b**2 + 0.0416666666666667*a**4*b + 0.03125*a**2*b)*(-0.166666666666667*a**4*b**5 - 0.0833333333333333*a**4*b**4*y + 0.333333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3*y - 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2*y + 0.0555555555555557*a**2*b**3*c + 0.0277777777777778*a**2*b**3 + 0.0416666666666667*a**2*b**2*y - 0.0833333333333333*a**2*b**2 - 0.0555555555555557*a**2*b*c - 0.0416666666666667*a**2*b*y + 0.0416666666666667*a**2*b - 0.00694444444444443*a**2*y - 0.0138888888888889*b*c + 0.00347222222222223*b - 0.00520833333333333*y)/((0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111)*(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)) + 0.333333333333333*(-0.25*a**6*b**6 + 0.5*a**6*b**5 - 0.25*a**6*b**4 + 0.104166666666667*a**4*b**4 - 0.0833333333333333*a**4*b**3 - 0.0416666666666667*a**4*b**2 - 0.00520833333333333*a**2*b**2 - 0.0104166666666667*a**2*b - 0.00173611111111111*a**2 - 0.00130208333333333)/(0.25*a**6*b**4 - 0.5*a**6*b**3 + 0.25*a**6*b**2 - 0.166666666666667*a**4*b**2*c + 0.0416666666666667*a**4*b**2 + 0.166666666666667*a**4*b*c - 0.0416666666666667*a**4*b + 0.0208333333333333*a**4 + 0.0138888888888889*a**2*c + 0.00173611111111111*a**2)) - (-0.0833333333333333*a**4*b**4 + 0.166666666666667*a**4*b**3 - 0.0833333333333333*a**4*b**2 + 0.0416666666666667*a**2*b**2 - 0.0416666666666667*a**2*b - 0.00694444444444443*a**2 - 0.00520833333333333)/(0.25*a**4*b**4 - 0.5*a**4*b**3 + 0.25*a**4*b**2 - 0.166666666666667*a**2*b**2*c + 0.0416666666666667*a**2*b**2 + 0.166666666666667*a**2*b*c - 0.0416666666666667*a**2*b + 0.0208333333333333*a**2 + 0.0138888888888889*c + 0.00173611111111111))


class SmoothCompactBumpFunction(tfp.bijectors.Bijector):

    def __init__(self, a, b, c,  name = 'SmoothCompactBumpFunction'):
      super(SmoothCompactBumpFunction, self).__init__(forward_min_event_ndims=0, name = name)
      self.a = a
      self.b = b
      self.c = c

    def _forward(self, x):
      return f(x, self.a, self.b, self.c)

    def _inverse(self, y):
      return inv_f(y,self.a, self.b, self.c)

    def _forward_log_det_jacobian(self, x):
      grad = gradf(x,self.a,self.b,self.c)
      return jnp.atleast_2d(jnp.log(jnp.abs(jnp.prod(grad, axis=1)))).T
